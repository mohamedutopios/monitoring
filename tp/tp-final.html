
		<head>
			<style type="text/css" media="screen">
				body,html{font-family:var(--markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", system-ui, "Ubuntu", "Droid Sans", sans-serif);font-size:var(--markdown-font-size,14px);padding:0 26px;line-height:var(--markdown-line-height,22px);word-wrap:break-word}body{padding-top:1em}h1,h2,h3,h4,h5,h6,ol,p,pre,ul{margin-top:0}h2,h3,h4,h5,h6{font-weight:400;margin-bottom:.2em}img{max-width:100%;max-height:100%}a{text-decoration:none}a:hover{text-decoration:underline}a:focus,input:focus,select:focus,textarea:focus{outline:1px solid -webkit-focus-ring-color;outline-offset:-1px}p{margin-bottom:.7em}ol,ul{margin-bottom:.7em}hr{border:0;height:2px;border-bottom:2px solid}h1{padding-bottom:.3em;line-height:1.2;border-bottom-width:1px;border-bottom-style:solid;font-weight:400}table{border-collapse:collapse}th{text-align:left;border-bottom:1px solid}td,th{padding:5px 10px}table>tbody>tr+tr>td{border-top:1px solid}blockquote{margin:0 7px 0 5px;padding:0 16px 0 10px;border-left-width:5px;border-left-style:solid}code{font-family:var(--vscode-editor-font-family, "SF Mono", Monaco, Menlo, Consolas, "Ubuntu Mono", "Liberation Mono", "DejaVu Sans Mono", "Courier New", monospace);font-size:1em;line-height:1.357em}body.wordWrap pre{white-space:pre-wrap}pre.hljs code>div,pre:not(.hljs){padding:16px;border-radius:3px;overflow:auto}pre code{color:var(--vscode-editor-foreground);tab-size:4}
			</style>
		</head>
		<body>
			<h1 id="ğŸ§ª-tp--supervision-et-alerting-multi-vm-avec-prometheus-grafana-alertmanager-et-node-exporter">ğŸ§ª TP : Supervision et Alerting Multi-VM avec Prometheus, Grafana, Alertmanager et Node Exporter</h1>
<h2 id="ğŸ¯-objectif-du-tp">ğŸ¯ Objectif du TP</h2>
<p>Vous allez mettre en place une <strong>infrastructure complÃ¨te de supervision</strong> basÃ©e sur <strong>Prometheus, Grafana, Alertmanager</strong> et <strong>Node Exporter</strong>, rÃ©partie sur <strong>3 machines virtuelles Ubuntu</strong>.
Le but est de surveiller lâ€™Ã©tat des serveurs, de dÃ©clencher des alertes (par mail ou Slack), et de visualiser lâ€™ensemble dans un dashboard personnalisÃ© (ou existant dans une banque de donnÃ©e Grafana).</p>
<h2 id="ğŸ–¥ï¸-environnement-de-travail">ğŸ–¥ï¸ Environnement de travail</h2>
<table>
<thead>
<tr>
<th>Nom de la VM</th>
<th>RÃ´le</th>
</tr>
</thead>
<tbody><tr>
<td><code>vm-prometheus</code></td>
<td>Serveur de supervision (Prometheus + Grafana + Alertmanager)</td>
</tr>
<tr>
<td><code>vm-server1</code></td>
<td>Serveur supervisÃ© nÂ°1 (avec Node Exporter)</td>
</tr>
<tr>
<td><code>vm-server2</code></td>
<td>Serveur supervisÃ© nÂ°2 (avec Node Exporter)</td>
</tr>
</tbody></table>
<blockquote>
<h1 id="les-3-machines-tournent-sur-vmware-workstation-pas-desxi-">Les 3 machines tournent sur VMware Workstation (pas d&#39;ESXi) !!</h1>
</blockquote>
<h2 id="ğŸ§©-Ã©tapes-du-tp">ğŸ§© Ã‰tapes du TP</h2>
<h3 id="ğŸ”¹-Ã©tape-1--prÃ©paration-des-machines">ğŸ”¹ Ã‰tape 1 â€” PrÃ©paration des machines</h3>
<ol>
<li>VÃ©rifiez que les 3 VMs ont bien un accÃ¨s rÃ©seau entre elles (testez avec <code>ping</code> ou <code>curl</code>).</li>
<li>Mettez Ã  jour les paquets et installez les utilitaires de base nÃ©cessaires.</li>
<li>Donnez un <strong>nom dâ€™hÃ´te explicite</strong> Ã  chaque machine (<code>vm-prometheus</code>, <code>vm-server1</code>, <code>vm-server2</code>).</li>
</ol>
<h3 id="ğŸ”¹-Ã©tape-2--installation-des-composants">ğŸ”¹ Ã‰tape 2 â€” Installation des composants</h3>
<h4 id="sur-vm-prometheus-">Sur <code>vm-prometheus</code> :</h4>
<ul>
<li><p>Installez et configurez :</p>
<ul>
<li>Prometheus</li>
<li>Grafana</li>
<li>Alertmanager</li>
</ul>
</li>
<li><p>Assurez-vous que chaque service dÃ©marre au boot et Ã©coute sur son port standard.</p>
</li>
</ul>
<h4 id="sur-vm-server1-et-vm-server2-">Sur <code>vm-server1</code> et <code>vm-server2</code> :</h4>
<ul>
<li>Installez <strong>Node Exporter</strong></li>
<li>Assurez-vous quâ€™il sâ€™exÃ©cute comme un service et expose les mÃ©triques sur le port 9100.</li>
</ul>
<h3 id="ğŸ”¹-Ã©tape-3--configuration-de-prometheus">ğŸ”¹ Ã‰tape 3 â€” Configuration de Prometheus</h3>
<ol>
<li>Configurez Prometheus pour rÃ©cupÃ©rer les mÃ©triques depuis <code>vm-server1</code> et <code>vm-server2</code>.</li>
<li>Associez des <strong>labels clairs</strong> Ã  chaque instance (ex : <code>instance: server1</code>, <code>instance: server2</code>).</li>
<li>Mettez en place un dossier dÃ©diÃ© pour les rÃ¨gles (<code>rules/</code>) et prÃ©parez Prometheus Ã  charger vos futures rÃ¨gles dâ€™alerte.</li>
</ol>
<h3 id="ğŸ”¹-Ã©tape-4--crÃ©ation-des-rÃ¨gles-dalerte">ğŸ”¹ Ã‰tape 4 â€” CrÃ©ation des rÃ¨gles dâ€™alerte</h3>
<p>Vous devez crÃ©er deux rÃ¨gles dans un fichier dÃ©diÃ© :</p>
<ul>
<li><p>Une alerte <strong>pour <code>vm-server1</code></strong> lorsque lâ€™espace disque utilisÃ© dÃ©passe <strong>50%</strong> pendant plus d&#39;une minute.
Cette alerte devra Ãªtre <strong>envoyÃ©e par mail</strong> Ã  <code>mohamed@utopios.net</code>.</p>
</li>
<li><p>Une alerte <strong>pour <code>vm-server2</code></strong> lorsqu&#39;une <strong>charge Ã©levÃ©e</strong> est dÃ©tectÃ©e (par exemple : load &gt; 1).
Cette alerte devra Ãªtre <strong>envoyÃ©e sur un canal Slack</strong> appelÃ© <code>#probleme-server2</code>.</p>
</li>
</ul>
<blockquote>
<p>Chaque rÃ¨gle devra contenir une <strong>description claire</strong> et un <strong>niveau de sÃ©vÃ©ritÃ©</strong>.</p>
</blockquote>
<h3 id="ğŸ”¹-Ã©tape-5--configuration-dalertmanager">ğŸ”¹ Ã‰tape 5 â€” Configuration dâ€™Alertmanager</h3>
<ol>
<li><p>CrÃ©ez une configuration pour <strong>router les alertes vers diffÃ©rents &quot;receivers&quot;</strong> :</p>
<ul>
<li>Un <strong>receiver email</strong> pour les alertes <code>server1</code></li>
<li>Un <strong>receiver Slack</strong> pour les alertes <code>server2</code></li>
</ul>
</li>
<li><p>Configurez un <strong>routing conditionnel</strong> basÃ© sur les labels dâ€™alerte (par exemple <code>instance</code> ou <code>alert_target</code>).</p>
</li>
<li><p>VÃ©rifiez que la configuration est bien prise en compte au redÃ©marrage du service.</p>
</li>
</ol>
<h3 id="ğŸ”¹-Ã©tape-6--configuration-de-grafana">ğŸ”¹ Ã‰tape 6 â€” Configuration de Grafana</h3>
<ol>
<li>Connectez Grafana Ã  Prometheus comme source de donnÃ©es.</li>
</ol>
<h4 id="option-2--creation-de-son-dashboard">Option 2 : Creation de son dashboard</h4>
<ol start="2">
<li><p>CrÃ©ez un <strong>dashboard unique</strong> avec les Ã©lÃ©ments suivants :</p>
<ul>
<li>Utilisation disque pour <code>vm-server1</code></li>
<li>Charge systÃ¨me pour <code>vm-server2</code></li>
<li>CPU et RAM pour les deux serveurs</li>
<li>Un panneau qui affiche lâ€™Ã©tat des alertes actives</li>
</ul>
</li>
<li><p>Organisez votre dashboard de faÃ§on claire et exploitable.</p>
</li>
</ol>
<h4 id="option-1--utilisation-dashboard-propoosÃ©-par-grafana">Option 1 : Utilisation Dashboard propoosÃ© par Grafana</h4>
<p>Le <strong>dashboard</strong> ou les <strong>dashboard</strong> aura, Ã  minima, les Ã©lÃ©ments suivants :</p>
<ul>
<li>Utilisation disque pour <code>vm-server1</code></li>
<li>Charge systÃ¨me pour <code>vm-server2</code></li>
<li>CPU et RAM pour les deux serveurs</li>
<li>Un panneau qui affiche lâ€™Ã©tat des alertes actives</li>
</ul>
<h3 id="ğŸ”¹-Ã©tape-7--vÃ©rification-des-alertes-et-simulation">ğŸ”¹ Ã‰tape 7 â€” VÃ©rification des alertes et simulation</h3>
<h4 id="pour-vm-server1-">Pour <code>vm-server1</code> :</h4>
<ul>
<li>Simulez une consommation importante de disque (sans danger pour le systÃ¨me).</li>
<li>VÃ©rifiez le dÃ©clenchement de lâ€™alerte dans Prometheus et la rÃ©ception du <strong>mail</strong>.</li>
</ul>
<h4 id="pour-vm-server2-">Pour <code>vm-server2</code> :</h4>
<ul>
<li>Lancez un processus qui augmente temporairement la charge systÃ¨me (ex: <code>stress</code>).</li>
<li>VÃ©rifiez la rÃ©ception dâ€™une <strong>notification Slack</strong>.</li>
</ul>
<blockquote>
<p>VÃ©rifiez aussi que lâ€™information est visible et cohÃ©rente sur le dashboard Grafana.</p>
</blockquote>
<h3 id="ğŸ”¹-Ã©tape-8--rendu-et-validation">ğŸ”¹ Ã‰tape 8 â€” Rendu et validation</h3>
<p>Chaque binÃ´me devra fournir :</p>
<ol>
<li><p>Une capture dâ€™Ã©cran de Grafana avec les bons panels visibles.</p>
</li>
<li><p>Une capture dâ€™Ã©cran du mail et de la notification Slack reÃ§us.</p>
</li>
<li><p>Une courte note expliquant :</p>
<ul>
<li>Les mÃ©triques utilisÃ©es dans chaque alerte</li>
<li>Comment la configuration des routes Alertmanager a Ã©tÃ© pensÃ©e</li>
<li>Ce qui pourrait Ãªtre amÃ©liorÃ© pour une production rÃ©elle</li>
</ul>
</li>
</ol>

		</body>